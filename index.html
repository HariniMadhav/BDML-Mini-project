<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Heart Disease Predictor</title>
<meta name="viewport" content="width=device-width,initial-scale=1" />

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">

<style>
body {
  margin: 0;
  font-family: 'Poppins', sans-serif;
  background: linear-gradient(135deg, #ffecd2, #fcb69f, #a1c4fd, #c2e9fb);
  background-size: 400% 400%;
  animation: gradientBG 10s ease infinite;
  color: #333;
}
@keyframes gradientBG {
  0% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}
.container {
  max-width: 1100px;
  margin: 40px auto;
  padding: 20px;
}
header {
  text-align: center;
  margin-bottom: 40px;
}
header h1 {
  color: #ffffff;
  font-size: 2.5rem;
  text-shadow: 2px 2px 10px rgba(0,0,0,0.2);
}
header p {
  color: #f0f0f0;
  font-size: 1.1rem;
}
.card {
  background: rgba(255, 255, 255, 0.9);
  border-radius: 20px;
  padding: 30px;
  box-shadow: 0 8px 25px rgba(0,0,0,0.15);
  margin-bottom: 30px;
  transition: transform 0.3s ease, box-shadow 0.3s ease;
}
.card:hover {
  transform: translateY(-5px);
  box-shadow: 0 12px 30px rgba(0,0,0,0.2);
}
h2 {
  color: #007bff;
  margin-bottom: 15px;
  font-size: 1.5rem;
}
label {
  display: block;
  margin-top: 10px;
  font-weight: 500;
}
input[type="number"] {
  width: 100%;
  padding: 10px;
  border: 2px solid #ddd;
  border-radius: 8px;
  margin-top: 5px;
  transition: border 0.3s;
}
input[type="number"]:focus {
  border-color: #007bff;
  outline: none;
}
.btn {
  display: inline-block;
  background: linear-gradient(135deg, #007bff, #00c6ff);
  color: #fff;
  padding: 12px 20px;
  border-radius: 10px;
  border: none;
  cursor: pointer;
  font-weight: 600;
  margin-top: 20px;
  font-size: 1rem;
  box-shadow: 0 5px 15px rgba(0,123,255,0.3);
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}
.btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 20px rgba(0,123,255,0.4);
}
.result-box {
  background: #e0ffe5;
  color: #155724;
  padding: 12px 18px;
  border-radius: 10px;
  margin-top: 15px;
  font-weight: 600;
  box-shadow: 0 3px 10px rgba(0,0,0,0.1);
}
.error-box {
  background: #ffe5e5;
  color: #721c24;
  padding: 12px 18px;
  border-radius: 10px;
  margin-top: 15px;
  font-weight: 600;
  box-shadow: 0 3px 10px rgba(0,0,0,0.1);
}
table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 15px;
}
th, td {
  border: 1px solid #ddd;
  padding: 10px;
  text-align: center;
}
th {
  background-color: #007bff;
  color: white;
}
footer {
  text-align: center;
  margin-top: 30px;
  color: #fff;
  font-size: 1rem;
  text-shadow: 1px 1px 5px rgba(0,0,0,0.3);
}
</style>
</head>
<body>

<div class="container">
  <header>
    <h1>Heart Disease Prediction Dashboard</h1>
    <p>Enter your health details to predict your heart disease risk</p>
  </header>

  <div class="card">
    <h2>Single Prediction</h2>
        <form id="singleForm">
            <div style="display:grid; grid-template-columns: repeat(auto-fill,minmax(180px,1fr)); gap:12px;">
                <input name="age" placeholder="Age (29‚Äì77)" type="number" min="29" max="77" required>
                <input name="sex" placeholder="Sex (0=Female, 1=Male)" type="number" min="0" max="1" required>
                <input name="cp" placeholder="Chest Pain Type (0‚Äì3)" type="number" min="0" max="3" required>
                <input name="trestbps" placeholder="Resting BP (90‚Äì200)" type="number" min="90" max="200" required>
                <input name="chol" placeholder="Cholesterol (120‚Äì570)" type="number" min="120" max="570" required>
                <input name="fbs" placeholder="Fasting BS >120 mg/dl (0/1)" type="number" min="0" max="1" required>
                <input name="restecg" placeholder="Rest ECG (0‚Äì2)" type="number" min="0" max="2" required>
                <input name="thalach" placeholder="Max Heart Rate (70‚Äì210)" type="number" min="70" max="210" required>
                <input name="exang" placeholder="Exercise Angina (0/1)" type="number" min="0" max="1" required>
                <input name="oldpeak" placeholder="Oldpeak (0.0‚Äì6.2)" type="number" step="0.1" min="0" max="6.2" required>
                <input name="slope" placeholder="Slope (0‚Äì2)" type="number" min="0" max="2" required>
                <input name="ca" placeholder="CA (0‚Äì4)" type="number" min="0" max="4" required>
                <input name="thal" placeholder="Thal (1‚Äì3)" type="number" min="1" max="3" required>
            </div>
        <button class="btn" type="submit">üîç Predict</button>
    </form>
    <div id="singleResult" class="result-box" style="display:none;"></div>
  </div>

  <div class="card">
    <h2>Dataset Analytics</h2>
    <p>Summary statistics for numeric columns</p>
    <div id="stats"></div>
  </div>

  <footer>
    ¬© 2025 Heart Disease AI Dashboard | Designed with love
  </footer>
</div>

<script>
const FEATURE_ORDER = ["age","sex","cp","trestbps","chol","fbs","restecg","thalach","exang","oldpeak","slope","ca","thal"];

document.getElementById('singleForm').addEventListener('submit', async (e)=>{
  e.preventDefault();
  const fd = new FormData(e.target);
  const features = FEATURE_ORDER.map(k => Number(fd.get(k)));
  const resultBox = document.getElementById('singleResult');
  resultBox.style.display = 'block';
  resultBox.innerText = 'Predicting...';
  try {
    const res = await fetch('/predict', {
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body: JSON.stringify({features})
    });
    const data = await res.json();
    if (data.error) {
      resultBox.className = 'error-box';
      resultBox.innerText = 'Error: ' + data.error;
    } else {
      resultBox.className = 'result-box';
      const p = data.probabilities ? (data.probabilities.disease * 100).toFixed(1) : '-';
      resultBox.innerText = `${data.prediction} (Disease Probability: ${p}%)`;
    }
  } catch(err){
    resultBox.className = 'error-box';
    resultBox.innerText = 'Server error';
  }
});

async function fetchAnalytics(){
  try{
    const resp = await fetch('/analytics');
    const data = await resp.json();
    if(data.error){
      document.getElementById('stats').innerText = data.error;
      return;
    }
    const summary = data.summary || {};
    let html = '<table><tr><th>Feature</th><th>Mean</th><th>Std</th></tr>';
    for(const col in summary){
      const m = summary[col].mean ? summary[col].mean.toFixed(3) : '-';
      const s = summary[col].std ? summary[col].std.toFixed(3) : '-';
      html += `<tr><td>${col}</td><td>${m}</td><td>${s}</td></tr>`;
    }
    html += '</table>';
    document.getElementById('stats').innerHTML = html;
  }catch(e){
    document.getElementById('stats').innerText = 'Error fetching analytics';
  }
}
fetchAnalytics();
</script>

</body>
</html>
